{"files":[{"filename":"schema-01-systematic.prisma","namespace":"Systematic","models":[{"name":"discussion_board_categories","description":"Discussion Board Category - Implements category management and administration from requirements.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"name","type":"string","description":"Category name. Unique, used to group topics.","nullable":false},{"name":"description","type":"string","description":"Optional details about the category's use or scope.","nullable":true},{"name":"parent_id","type":"uuid","description":"Self-reference for hierarchy. Null for top-level categories.","nullable":true},{"name":"is_active","type":"boolean","description":"Is the category currently enabled for participation?","nullable":false},{"name":"created_at","type":"datetime","description":"Creation timestamp for this category row.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last updated timestamp for this row.","nullable":false}],"uniqueIndexes":[{"fieldNames":["name"],"unique":true}],"plainIndexes":[{"fieldNames":["is_active"]},{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"discussion_board_settings","description":"Discussion Board persistent settings table for board-level options and toggles.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"setting_key","type":"string","description":"Setting key, e.g., 'registration_open'. Must be unique.","nullable":false},{"name":"setting_value","type":"string","description":"Value of the setting. Text-based for flexibility.","nullable":false},{"name":"description","type":"string","description":"Optional description of what this setting controls.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for this setting row.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last updated timestamp for this row.","nullable":false}],"uniqueIndexes":[{"fieldNames":["setting_key"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"discussion_board_category_moderators","description":"Junction table mapping moderators to categories for M:N relationship per requirements. Each assignment is unique per (category_id, moderator_id).","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"category_id","type":"uuid","description":"Reference to discussion_board_categories.id.","relation":{"name":"discussion_board_category_moderators_category_id_fkey","targetModel":"discussion_board_categories","targetField":"id"},"unique":false,"nullable":false},{"name":"moderator_id","type":"uuid","description":"Reference to discussion_board_moderators.id (from Actors schema).","relation":{"name":"discussion_board_category_moderators_moderator_id_fkey","targetModel":"discussion_board_moderators","targetField":"id"},"unique":false,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","description":"Assignment event creation timestamp.","nullable":false}],"uniqueIndexes":[{"fieldNames":["category_id","moderator_id"],"unique":true}],"plainIndexes":[{"fieldNames":["category_id"]},{"fieldNames":["moderator_id"]}],"ginIndexes":[]},{"name":"discussion_board_audit_logs","description":"System auditing log for key events (config changes, assignments, bans, etc.). Append-only. Used for compliance and troubleshooting.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"actor_id","type":"uuid","description":"ID (UUID) of actor (admin/moderator/member/user) who performed the event. Null for system actions.","relation":{"name":"discussion_board_audit_logs_actor_id_fkey","targetModel":"discussion_board_admins","targetField":"id"},"unique":false,"nullable":true},{"name":"target_id","type":"uuid","description":"Generic target object id affected by the action. Null if not applicable.","relation":{"name":"discussion_board_audit_logs_target_id_fkey","targetModel":"discussion_board_categories","targetField":"id"},"unique":false,"nullable":true}],"plainFields":[{"name":"action_type","type":"string","description":"Type of action performed (e.g., 'assign_moderator').","nullable":false},{"name":"action_detail","type":"string","description":"Additional details or context for the event. Null if not given.","nullable":true},{"name":"created_at","type":"datetime","description":"Event timestamp for the audit log entry.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["actor_id"]},{"fieldNames":["target_id"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"action_type"}]},{"name":"discussion_board_system_notices","description":"System notices/messages for all or selected users (e.g., banners, important updates, system-wide or per-category, possibly scheduled).","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"category_id","type":"uuid","description":"Optional reference to discussion_board_categories.id. Null means global notice.","relation":{"name":"discussion_board_system_notices_category_id_fkey","targetModel":"discussion_board_categories","targetField":"id"},"unique":false,"nullable":true}],"plainFields":[{"name":"title","type":"string","description":"Notice headline/title.","nullable":false},{"name":"body","type":"string","description":"Message content for the notice.","nullable":false},{"name":"is_active","type":"boolean","description":"Is the notice currently displayed/shown?","nullable":false},{"name":"start_at","type":"datetime","description":"Optional start date for scheduling visible time. Null = always until end_at.","nullable":true},{"name":"end_at","type":"datetime","description":"Optional end date for scheduling end of visibility. Null = indefinite.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation time for audit/history.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last updated time.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["is_active"]},{"fieldNames":["category_id"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"title"},{"fieldName":"body"}]}]},{"filename":"schema-02-actors.prisma","namespace":"Actors","models":[{"name":"discussion_board_admins","description":"Discussion Board Admins - This implements the requirement for full-platform control and high-level configuration as described in roles and permissions requirements. \n\nAdmins manage the system's configuration, assign or revoke moderation privileges, configure categories, and have access to analytics, audit logs, and sensitive management features. Maintains 3NF compliance by isolating admin-specific data from other actor roles. For example, when a new admin is registered or an existing member is promoted, a single record is created here with responsible actor and relevant timestamps. \n\nKey relationships: Typically references a user identity core record (external) and logs role-specific metadata. \nSpecial behaviors: Only records in this table may alter board configuration or perform overarching system management actions.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for each admin actor instance."},"foreignFields":[],"plainFields":[{"name":"user_identifier","type":"string","description":"User identifier - Implements the admin mapping aspect from requirements. The business user (system-wide or external reference, e.g., email or UID) that this admin role is assigned to. Ensures normalization by storing a single atomic identifier. For example, the platform user's UUID or SSO ID. Cannot be null.","nullable":false},{"name":"granted_at","type":"datetime","description":"Grant timestamp - Represents when admin privileges were assigned. This supports audit trails, ensuring full actor traceability. For example, when a user is promoted, this is set to current timestamp.","nullable":false},{"name":"revoked_at","type":"datetime","description":"Revocation timestamp - If admin rights are rescinded, this records when. Normalization ensures separation from business dataâ€”no status flags, just event time. For example, set when admin demotion is processed. Nullable (current if null).","nullable":true}],"uniqueIndexes":[{"fieldNames":["user_identifier"],"unique":true}],"plainIndexes":[{"fieldNames":["granted_at"]},{"fieldNames":["revoked_at"]}],"ginIndexes":[]},{"name":"discussion_board_moderators","description":"Discussion Board Moderators - Fulfills the requirement for stewardship, moderation, and enforcement powers outlined in the business requirements. \n\nStores data on platform-approved moderators who manage flagged content, enforce rules, and resolve user reports. Maintains 3NF: Contains only moderator-specific role/temporal status info, not general user info.\n\nUsage: When an admin appoints a user as moderator, this model is updated. Example: moderator is temporarily promoted, tracked by granted/revoked timestamps.\n\nKey relationships: Should reference the user identity core record (external). Special behaviors: Only these users may moderate board content. Moderator history allows for temporary appointments and role audits.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for the moderator role assignment."},"foreignFields":[],"plainFields":[{"name":"user_identifier","type":"string","description":"User identifier - Implements role actor mapping. Identifies which user has moderator privilege. Ensures a flexible mapping to central user/auth system. Example: contains user UUID. Non-nullable.","nullable":false},{"name":"granted_at","type":"datetime","description":"Role grant timestamp - Implements time-based access control for moderators. Defines when privilege started. Ensures normalized audit trail: e.g., moderating user granted the role on this date.","nullable":false},{"name":"revoked_at","type":"datetime","description":"Role revocation timestamp - Supports time-boxed moderator roles and historical traceability for audit. Null if moderator powers still active. Example: removed when privilege is lost or user is demoted. Nullable.","nullable":true}],"uniqueIndexes":[{"fieldNames":["user_identifier"],"unique":true}],"plainIndexes":[{"fieldNames":["granted_at"]},{"fieldNames":["revoked_at"]}],"ginIndexes":[]},{"name":"discussion_board_members","description":"Discussion Board Members - This captures all active registered users per system requirements. Implements business requirement for authenticated users with member privileges who can post, comment, report, and otherwise participate fully on the board.\n\nIs strictly 3NF: contains only what is unique/relevant to the member role, not detailed user data or computed features. For example, a new member record is created upon registration or promotion from guest status.\n\nKey relationships: May reference external user directory/identity tables.\nSpecial behaviors: Additional flags/elevation handled via role-specific models (admin, moderator, etc.). Only users listed here may create threads or comments.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for registered member record."},"foreignFields":[],"plainFields":[{"name":"user_identifier","type":"string","description":"User identifier - Implements member-account mapping to platform-wide or external user. Ensures atomic mapping to user identity. Example: could be user UUID, email, SSO subject. Non-nullable.","nullable":false},{"name":"joined_at","type":"datetime","description":"Join timestamp - When the member registered on the board. Enables user analytics/audit logging. For example, set to creation date for analytics use.","nullable":false},{"name":"suspended_at","type":"datetime","description":"Suspension timestamp - If the member is barred from participation, logs when suspension took effect. Normalized: retains only the timestamp, not pre-calculated status. Null if active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["user_identifier"],"unique":true}],"plainIndexes":[{"fieldNames":["joined_at"]},{"fieldNames":["suspended_at"]}],"ginIndexes":[]},{"name":"discussion_board_guests","description":"Discussion Board Guests - Implements the requirement for unauthenticated users who may browse (but not act) on public content, as per business requirements. \n\nStores session-level tracking for guests (cookies, tokens, or temporary IDs) to distinguish unique visitors, support analytics, or inform onboarding flows (e.g., one-time announcements).\n\n3NF: No computed access flags, just raw identity and time stamps. Example: new guest detected (session/cookie assignment) creates a record here for behavior tracking until registration.\n\nKey relationships: Standalone design, with possible linkage to analytics/log tables.\nSpecial behaviors: Only guests here are treated as unique browsers for basic auditingâ€”no personal data unless promoted to member.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique ID for the tracked guest session."},"foreignFields":[],"plainFields":[{"name":"session_identifier","type":"string","description":"Session identifier - Implements tracking of guest/visitor session via cookie/token/UUID. Ensures atomicity and normalizes identification for auditing/analytics. For example, a one-time session ID. Required for all guest sessions.","nullable":false},{"name":"first_seen_at","type":"datetime","description":"First seen timestamp - When this guest was first detected by the system. For session analysis/onboarding optimization. Non-nullable.","nullable":false},{"name":"last_seen_at","type":"datetime","description":"Last seen timestamp - Last activity by this guest before exit or registration. Helps track unique visitors and session duration; normalized storage. Non-nullable.","nullable":false}],"uniqueIndexes":[{"fieldNames":["session_identifier"],"unique":true}],"plainIndexes":[{"fieldNames":["first_seen_at"]},{"fieldNames":["last_seen_at"]}],"ginIndexes":[]},{"name":"discussion_board_user_sessions","description":"Discussion Board User Sessions - Fulfills the cross-role requirement for persistent login/session tracking to support authentication, session management, and traceability, as required by the technical/API documentation.\n\nManages every authenticated or tracked session (admin, moderator, member, or guest), enabling token-based authentication, session expiry, user-actor analytics, and auto-logout on privilege changes. Maintains 3NF: holds only direct session facts, not computed fields or summaries. Example: a user logs in, a session is created here with user and session info, plus expiry fields for security/audit logging.\n\nKey relationships: Should reference user identifier (admin, moderator, member) or guest session. No other foreign keysâ€”designed for compatibility with all actor types.\n\nSpecial behaviors: Only these records define active sessions. Session termination/expiry and forced logout for security is enforced by updating or nulling the termination timestamp. Role/applicable features determined externally (not here).","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for the user/guest session."},"foreignFields":[],"plainFields":[{"name":"actor_type","type":"string","description":"Actor type - Group discriminator (e.g., 'admin', 'moderator', 'member', 'guest'). Implements cross-role session context, as required by session management documentation. Ensures normalization by direct storage; no duplication of other user data. Example: 'moderator'. Non-nullable.","nullable":false},{"name":"actor_identifier","type":"string","description":"Actor identifier - Implements session-to-user/guest linkage (contains user_identifier or session_identifier as per actor_type). Normalizes reference to actor record, following atomic data principles. Non-nullable.","nullable":false},{"name":"session_token","type":"string","description":"Session token - Stores opaque session token (e.g., JWT, UUID, cookie) for authentication. Supports per-session tracking for forced logouts, API/request scoping. Normalization: only token string, never computed status. Example: a unique token generated at login. Non-nullable.","nullable":false},{"name":"created_at","type":"datetime","description":"Session creation timestamp - For session timeline, auditing, and active user tracking. Example: when login completes or guest arrives. Non-nullable.","nullable":false},{"name":"expires_at","type":"datetime","description":"Session expiry timestamp - When session is set to expire; enables auto-logout, security enforcement, and short/long session analytics. Non-nullable.","nullable":false},{"name":"terminated_at","type":"datetime","description":"Termination timestamp (logout/kicked/timeout) - Supports hard logouts, token revocation, audit trails for suspicious/revoked sessions. Normalized: timestamp only, nullable if not terminated yet. For example, updated on manual logout, role loss, or session timeout. Nullable.","nullable":true}],"uniqueIndexes":[{"fieldNames":["session_token"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]},{"fieldNames":["actor_type","actor_identifier"]}],"ginIndexes":[]}]},{"filename":"schema-03-articles.prisma","namespace":"Articles","models":[{"name":"discussion_board_topics","description":"Topics on the discussion board - Implements the requirements for topic and thread management from the Features & Workflow documentation, supporting the creation and organization of main discussion areas. This model allows users to see a list of topics, and admins/moderators to manage (pin, close, delete) topics. Maintains 3NF compliance by keeping only atomic, non-aggregated data with referential integrity for creator, category, and status. Key relationships: category (to discussion_board_categories) and creator (to discussion_board_members). Special behaviors: topics may be pinned, closed, or deleted; closure restricts new posts at thread level.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for each topic."},"foreignFields":[{"name":"discussion_board_category_id","type":"uuid","description":"Category association â€“ References the parent category's {@link discussion_board_categories.id} for hierarchical topic organization.","relation":{"name":"category","fields":["discussion_board_category_id"],"references":["id"],"targetModel":"discussion_board_categories"},"unique":false,"nullable":false},{"name":"creator_member_id","type":"uuid","description":"Creator member â€“ References the member's {@link discussion_board_members.id} who created the topic, needed for audit trail and permissions enforcement.","relation":{"name":"creator_member","fields":["creator_member_id"],"references":["id"],"targetModel":"discussion_board_members"},"unique":false,"nullable":false}],"plainFields":[{"name":"title","type":"string","description":"Topic title - Short text for headline display. Atomic, normalized.","nullable":false},{"name":"description","type":"string","description":"Topic description - Provides summary or guidelines for the topic. Optional, can be null for brief topics.","nullable":true},{"name":"pinned","type":"boolean","description":"Indicates if topic is pinned.","nullable":false},{"name":"closed","type":"boolean","description":"Indicates if topic is closed.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp of topic creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update to the topic.","nullable":false}],"uniqueIndexes":[{"fieldNames":["discussion_board_category_id","title"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]},{"fieldNames":["pinned"]}],"ginIndexes":[{"fieldName":"title"}]},{"name":"discussion_board_threads","description":"Threads within a topic - Implements threaded sub-discussions for separate conversations under one topic. Each thread belongs to a topic, and to a creator member. Fully normalized. Closure of parent topic invalidates new threads/posts.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for each thread."},"foreignFields":[{"name":"discussion_board_topic_id","type":"uuid","description":"Parent topic â€“ References {@link discussion_board_topics.id}, linking thread to its top-level area.","relation":{"name":"topic","fields":["discussion_board_topic_id"],"references":["id"],"targetModel":"discussion_board_topics"},"unique":false,"nullable":false},{"name":"creator_member_id","type":"uuid","description":"Thread starter â€“ References the member's {@link discussion_board_members.id} who created the thread.","relation":{"name":"creator_member","fields":["creator_member_id"],"references":["id"],"targetModel":"discussion_board_members"},"unique":false,"nullable":false}],"plainFields":[{"name":"title","type":"string","description":"Thread title - User-provided, atomic.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when thread created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update/modification.","nullable":false}],"uniqueIndexes":[{"fieldNames":["discussion_board_topic_id","title"],"unique":true}],"plainIndexes":[{"fieldNames":["discussion_board_topic_id","created_at"]}],"ginIndexes":[{"fieldName":"title"}]},{"name":"discussion_board_posts","description":"Atomic posts in discussion threads - Implements posting and commenting functionality. Each post is an individual contribution to a thread and references its creator and thread. Designed for atomic, normalized content. Soft-deletion handled by deleted_at. No aggregation of comment count/etc.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for each post."},"foreignFields":[{"name":"discussion_board_thread_id","type":"uuid","description":"Parent thread â€“ References {@link discussion_board_threads.id}.","relation":{"name":"thread","fields":["discussion_board_thread_id"],"references":["id"],"targetModel":"discussion_board_threads"},"unique":false,"nullable":false},{"name":"creator_member_id","type":"uuid","description":"Post author â€“ References {@link discussion_board_members.id}.","relation":{"name":"creator_member","fields":["creator_member_id"],"references":["id"],"targetModel":"discussion_board_members"},"unique":false,"nullable":false}],"plainFields":[{"name":"body","type":"string","description":"Post body - Markdown/atomic text. Not calculated.","nullable":false},{"name":"is_edited","type":"boolean","description":"Edit status - True if post edited. Atomic flag, 3NF compliant.","nullable":false},{"name":"created_at","type":"datetime","description":"Time of post creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Time of last update.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Deletion timestamp if soft-deleted. Nullable.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["discussion_board_thread_id","created_at"]}],"ginIndexes":[{"fieldName":"body"}]},{"name":"discussion_board_post_versions","description":"Snapshots of post revisions (version history/audit) - Implements snapshot-based architecture for post edit tracking, supporting rollback and audit history. Each entry stores a snapshot of the post content and incrementing version number. No aggregation. Each version is linked to an editor and to the associated post.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique, immutable identifier for each versioned snapshot."},"foreignFields":[{"name":"discussion_board_post_id","type":"uuid","description":"Target post â€“ References {@link discussion_board_posts.id}.","relation":{"name":"post","fields":["discussion_board_post_id"],"references":["id"],"targetModel":"discussion_board_posts"},"unique":false,"nullable":false},{"name":"editor_member_id","type":"uuid","description":"Editor responsible for this version â€“ References {@link discussion_board_members.id}.","relation":{"name":"editor_member","fields":["editor_member_id"],"references":["id"],"targetModel":"discussion_board_members"},"unique":false,"nullable":false}],"plainFields":[{"name":"version","type":"int","description":"Version number - Starts at 1, increments per edit.","nullable":false},{"name":"body","type":"string","description":"Snapshot of post content.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when version created.","nullable":false}],"uniqueIndexes":[{"fieldNames":["discussion_board_post_id","version"],"unique":true}],"plainIndexes":[{"fieldNames":["editor_member_id","created_at"]}],"ginIndexes":[{"fieldName":"body"}]},{"name":"discussion_board_post_attachments","description":"Attachment files for posts - Stores pure file/link metadata with reference to its post. Files are stored externally as URIs. Soft deletes handled via post or by removing external file, not by field aggregation. Each attachment links to both the post and uploader member.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for each attachment."},"foreignFields":[{"name":"discussion_board_post_id","type":"uuid","description":"Associated post â€“ References {@link discussion_board_posts.id}.","relation":{"name":"post","fields":["discussion_board_post_id"],"references":["id"],"targetModel":"discussion_board_posts"},"unique":false,"nullable":false},{"name":"uploader_member_id","type":"uuid","description":"Uploader â€“ References {@link discussion_board_members.id}.","relation":{"name":"uploader_member","fields":["uploader_member_id"],"references":["id"],"targetModel":"discussion_board_members"},"unique":false,"nullable":false}],"plainFields":[{"name":"file_uri","type":"uri","description":"Location of the attachment file (external or CDN URI). Atomic, normalized.","nullable":false},{"name":"file_name","type":"string","description":"Original file name. Plain text, atomic.","nullable":false},{"name":"mime_type","type":"string","description":"Attachment MIME type. E.g., 'image/png'.","nullable":false},{"name":"uploaded_at","type":"datetime","description":"Timestamp when file uploaded. Atomic event.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["uploaded_at"]}],"ginIndexes":[]}]},{"filename":"schema-04-comments.prisma","namespace":"Comments","models":[{"name":"discussion_board_comments","description":"Comment Entity - This implements the persistent storage of all user-submitted comments in discussions, derived principally from the Posting and Commenting, Reporting, and Moderation requirements. Enables business: Members (authenticated users) can add comments to posts or threads, drive participation, and trigger moderation/reporting workflows. Maintains 3NF compliance by storing only basic comment data here, with version history and attachments managed by related tables. For example, a member posts a reply under a thread; this comment is stored here, and all edits spawn version records in discussion_board_comment_versions. Key relationships: References creator/member, post/thread, and version history. Special behaviors: Enforces logical deletion (soft delete), role-based permissions, and audit trails via related domain tables.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for this comment entity instance, required for versioning, audit, and referencing from attachments, reports, or moderation actions."},"foreignFields":[{"name":"discussion_board_member_id","type":"uuid","description":"Belonged member's {@link discussion_board_members.id} Identifies the member who created the comment. This links each comment to a registered member in the Actors domain. Ensures only authenticated users can create comments. For example, when 'JaneDoe' comments on a thread, discussion_board_member_id references her unique member id.","relation":{"name":"fk_discussion_board_comments_member","targetModel":"discussion_board_members","targetField":"id","onDelete":"Restrict","onUpdate":"Cascade"},"unique":false,"nullable":false},{"name":"discussion_board_post_id","type":"uuid","description":"Target post's {@link discussion_board_posts.id} Associates comment with its parent post. Maintains comment thread context. For example, when commenting on a specific post in a topic, this points to the post id.","relation":{"name":"fk_discussion_board_comments_post","targetModel":"discussion_board_posts","targetField":"id","onDelete":"Cascade","onUpdate":"Cascade"},"unique":false,"nullable":false}],"plainFields":[{"name":"content","type":"string","description":"Current visible content of the comment - Implements base comment storage per Posting and Commenting requirements. Contains the editable text body at its most recent version. Ensures normalization by separating version history. For example, shows the latest text for all viewing users. Prohibited from containing calculation or aggregation data. Constraints: non-empty, max length per business rule.","nullable":false},{"name":"is_deleted","type":"boolean","description":"Soft delete flag - Supports moderation requirements and audit regulation. Indicates whether the comment is logically deleted (hidden but not physically removed). Preserves normalization; logical deletions marked here while historical data and audit remain intact. For example, when a comment is removed for moderation, it is flagged true here but retained for review purposes.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when the comment was created - Fulfills audit trail, reporting, and workflow timing requirements. Captures creation date and time for version order and temporal queries. For example, used in sorting threads by newest activity. Non-nullable, set at insert; not updatable.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp for most recent update - Implements last-change tracking per Posting/Moderation requirements. Records when this comment was last edited (directly, not via version). Distinct from versioning. For example, indicates if and when a comment was updated. Non-nullable; system-managed.","nullable":false}],"uniqueIndexes":[{"fieldNames":["discussion_board_member_id","created_at"],"unique":true}],"plainIndexes":[{"fieldNames":["discussion_board_post_id","created_at"]}],"ginIndexes":[{"fieldName":"content"}]},{"name":"discussion_board_comment_versions","description":"Comment Version Entity - Implements comment versioning as mandated by audit, edit history, and moderation transparency requirements. Business purpose: Captures every revision of a comment, supporting features like rollback, moderator review, or version diff display. Maintains 3NF by isolating mutable historic data from the main comments table. For example, if a member edits a comment three times, each version is preserved here for audit and possible reversion. Key relationships: Each record links to its parent comment and the editing member. Special constraints: Must maintain strict sequential ordering, cannot be orphaned.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Distinct identifier for this version entity. Guarantees auditibility and reference from moderation or analytics tables."},"foreignFields":[{"name":"discussion_board_comment_id","type":"uuid","description":"Parent comment's {@link discussion_board_comments.id} Defines which logical comment this version belongs to. Maintains strict referential integrity â€“ cannot exist unless parent exists. Example: all edits to Comment A reference its id.","relation":{"name":"fk_comment_versions_comment","targetModel":"discussion_board_comments","targetField":"id","onDelete":"Cascade","onUpdate":"Cascade"},"unique":false,"nullable":false},{"name":"editor_member_id","type":"uuid","description":"Editing member's {@link discussion_board_members.id} Records who performed this edit (original author or admin/moderator on behalf). Supports moderation requirements and rollback logic. For example, if a post is edited by moderator, reference shows the responsible party.","relation":{"name":"fk_comment_versions_editor","targetModel":"discussion_board_members","targetField":"id","onDelete":"Restrict","onUpdate":"Cascade"},"unique":false,"nullable":false}],"plainFields":[{"name":"content","type":"string","description":"Full content snapshot for this version - Implements versioning per Editing/Audit requirements. Holds exact comment text at time of this revision. Maintains normalization by never storing aggregated history or derived summaries. For example, supports diff view between versions. Constraints: non-nullable, limited to max allowed text size.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp for when the version was created - Satisfies audit and sequencing needs. Critical for ordering comment versions and reconstructing edit history. Non-nullable; fixed at version creation. System-managed; not modifiable after insertion.","nullable":false}],"uniqueIndexes":[{"fieldNames":["discussion_board_comment_id","created_at"],"unique":true}],"plainIndexes":[{"fieldNames":["editor_member_id","created_at"]}],"ginIndexes":[{"fieldName":"content"}]},{"name":"discussion_board_comment_attachments","description":"Comment Attachment Entity - Implements comment file/media upload and management in line with Posting and Commenting functional requirements and audit expectations. Business purpose: Enables the association of external files (e.g., images, documents) with user comments. Maintains normalization by separating binary/meta file data from core comment or version entities. For example, a user attaches a PNG file when commenting â€“ info here links the file and describes its purpose/type. Key relationships: References parent comment and the uploading member. May link to moderation, abuse workflows. Behavior notes: Attachment deletion upon comment removal is logical, not physical, until moderation review completes.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for each comment attachment; referenced from comment or moderation action records."},"foreignFields":[{"name":"discussion_board_comment_id","type":"uuid","description":"Parent comment's {@link discussion_board_comments.id} Links the attachment to the specific comment it accompanies. Preserves referential integrity, cascade deletes if comment is deleted. For example, when removing a comment, related attachments are flagged for review or logical deletion.","relation":{"name":"fk_comment_attachments_comment","targetModel":"discussion_board_comments","targetField":"id","onDelete":"Cascade","onUpdate":"Cascade"},"unique":false,"nullable":false},{"name":"uploader_member_id","type":"uuid","description":"Uploading member's {@link discussion_board_members.id} Identifies which member uploaded this attachment, fulfilling moderation and reporting needs. For example, provides traceability in the event of abuse or copyright complaints.","relation":{"name":"fk_comment_attachments_uploader","targetModel":"discussion_board_members","targetField":"id","onDelete":"Restrict","onUpdate":"Cascade"},"unique":false,"nullable":false}],"plainFields":[{"name":"file_name","type":"string","description":"Original filename as uploaded - Implements user experience and file management requirements. Captured to show download/display name. Normalized, atomic string, no file data or MIME-type here. Example: 'user-guide.pdf'.","nullable":false},{"name":"file_url","type":"uri","description":"URL or URI where file is stored - Implements file referencing and download logic. Contains the safe-accessible storage or CDN link for retrieval and scanning. For example: 'https://cdn.example.com/upload/abc1234.pdf'. Must be a valid URI. Completely normalized â€“ no aggregate content, no calculations, no stored binaries.","nullable":false},{"name":"mime_type","type":"string","description":"MIME type of attachment content - Implements compatibility and validation coverage. Stores attachment's content-type for serving/display and content policy enforcement. For example: 'image/png', 'application/pdf'. Required, non-nullable. Ensures only atomic media/meta data is present.","nullable":false},{"name":"uploaded_at","type":"datetime","description":"Timestamp for file upload - Fulfills audit and tracking for moderation or download logs. Set immediately upon successful upload. Not modifiable, required. Used for reporting and analytics. Example: display upload date/time on comment view or for anti-abuse workflow.","nullable":false}],"uniqueIndexes":[{"fieldNames":["discussion_board_comment_id","file_url"],"unique":true}],"plainIndexes":[{"fieldNames":["uploader_member_id","uploaded_at"]}],"ginIndexes":[]}]},{"filename":"schema-05-moderation.prisma","namespace":"Moderation","models":[{"name":"discussion_board_reports","description":"Reports of inappropriate or abusive content - Tracks user reports of posts or comments that may violate guidelines. Maintains strict 3NF by separating each report as an atomic record. Polymorphic reference resolved by two nullable foreign keys: one for post and one for comment.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for each report instance."},"foreignFields":[{"name":"reporter_id","type":"uuid","description":"Reporter user's {@link discussion_board_members.id}. Identifies who made the report. Ensures normalized reference to member entity.","relation":{"name":"fk_reporter_members","targetModel":"discussion_board_members","targetField":"id"},"unique":false,"nullable":false},{"name":"reported_post_id","type":"uuid","description":"The ID of the discussion_board_posts being reported. Null unless content_type is 'post'.","relation":{"name":"fk_reported_post_content","targetModel":"discussion_board_posts","targetField":"id"},"unique":false,"nullable":true},{"name":"reported_comment_id","type":"uuid","description":"The ID of the discussion_board_comments being reported. Null unless content_type is 'comment'.","relation":{"name":"fk_reported_comment_content","targetModel":"discussion_board_comments","targetField":"id"},"unique":false,"nullable":true}],"plainFields":[{"name":"content_type","type":"string","description":"Indicates what type of content is being reported, e.g., 'post' or 'comment'.","nullable":false},{"name":"reason","type":"string","description":"Explanation/reason for reporting content. Implements the user-provided reason requirement.","nullable":false},{"name":"status","type":"string","description":"Current moderation status of the report (e.g., 'pending', 'reviewed', 'resolved').","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when report was created.","nullable":false},{"name":"resolved_at","type":"datetime","description":"Timestamp when report was resolved (null if unresolved).","nullable":true}],"uniqueIndexes":[{"fieldNames":["reporter_id","reported_post_id","reported_comment_id"],"unique":true}],"plainIndexes":[{"fieldNames":["status"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"reason"}]},{"name":"discussion_board_moderation_actions","description":"Actions taken by moderators or admins regarding content moderation - Each moderation action references either a moderator or an admin (never both); action may target a post or a comment, resolved via separate nullable foreign keys.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for each moderation action event."},"foreignFields":[{"name":"actor_moderator_id","type":"uuid","description":"Moderator user's {@link discussion_board_moderators.id}. Null unless a moderator acted.","relation":{"name":"fk_actor_moderator","targetModel":"discussion_board_moderators","targetField":"id"},"unique":false,"nullable":true},{"name":"actor_admin_id","type":"uuid","description":"Admin user's {@link discussion_board_admins.id}. Null unless an admin acted.","relation":{"name":"fk_actor_admin","targetModel":"discussion_board_admins","targetField":"id"},"unique":false,"nullable":true},{"name":"post_id","type":"uuid","description":"The ID of the discussion_board_posts being moderated. Null unless the action targets a post.","relation":{"name":"fk_moderated_post","targetModel":"discussion_board_posts","targetField":"id"},"unique":false,"nullable":true},{"name":"comment_id","type":"uuid","description":"The ID of the discussion_board_comments being moderated. Null unless the action targets a comment.","relation":{"name":"fk_moderated_comment","targetModel":"discussion_board_comments","targetField":"id"},"unique":false,"nullable":true},{"name":"report_id","type":"uuid","description":"If action relates directly to a report, this field links to the discussion_board_reports entry. Nullable for stand-alone moderation.","relation":{"name":"fk_action_report","targetModel":"discussion_board_reports","targetField":"id"},"unique":false,"nullable":true}],"plainFields":[{"name":"action_type","type":"string","description":"Describes the moderation action performed (e.g., 'delete', 'edit', 'warn', 'ban').","nullable":false},{"name":"action_details","type":"string","description":"Additional details (eg, reason, notes, evidence).","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when moderation action was performed.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["actor_moderator_id","actor_admin_id","created_at"]},{"fieldNames":["post_id"]},{"fieldNames":["comment_id"]}],"ginIndexes":[{"fieldName":"action_details"}]},{"name":"discussion_board_content_flags","description":"Flags attached to posts or comments for moderation - Polymorphic reference is two separate nullable FKs (post and comment). Flagged by a moderator, admin, or system; these are represented by two nullable FKs for human actors.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for each content flag instance."},"foreignFields":[{"name":"post_id","type":"uuid","description":"ID of post being flagged. Nullable; set if flag is on a post.","relation":{"name":"fk_flagged_post","targetModel":"discussion_board_posts","targetField":"id"},"unique":false,"nullable":true},{"name":"comment_id","type":"uuid","description":"ID of comment being flagged. Nullable; set if flag is on a comment.","relation":{"name":"fk_flagged_comment","targetModel":"discussion_board_comments","targetField":"id"},"unique":false,"nullable":true},{"name":"flagged_by_moderator_id","type":"uuid","description":"Moderator user's {@link discussion_board_moderators.id}. Nullable.","relation":{"name":"fk_flagged_by_moderator","targetModel":"discussion_board_moderators","targetField":"id"},"unique":false,"nullable":true},{"name":"flagged_by_admin_id","type":"uuid","description":"Admin user's {@link discussion_board_admins.id}. Nullable.","relation":{"name":"fk_flagged_by_admin","targetModel":"discussion_board_admins","targetField":"id"},"unique":false,"nullable":true}],"plainFields":[{"name":"flag_type","type":"string","description":"Nature of flag (e.g., 'spam', 'abuse', 'automation', 'duplicate').","nullable":false},{"name":"flag_source","type":"string","description":"Source/origin of flag, e.g. 'manual', 'automation', 'external'.","nullable":false},{"name":"flag_details","type":"string","description":"Additional notes about why flag was set (free form, optional).","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when flag was created. Implements audit trace per EARS specs.","nullable":false},{"name":"cleared_at","type":"datetime","description":"Timestamp when flag was cleared/resolved (null if still active).","nullable":true}],"uniqueIndexes":[{"fieldNames":["post_id","comment_id","flag_type","flag_source"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]},{"fieldNames":["flag_type"]}],"ginIndexes":[{"fieldName":"flag_details"}]}]},{"filename":"schema-06-notifications.prisma","namespace":"Notifications","models":[{"name":"discussion_board_subscriptions","description":"Discussion board subscription management - This implements the requirements for user subscriptions to topics or threads, as stated in 'Notification and Subscription' and 'Workflow Summary' in the requirements document. \n\nBusiness purpose: Allows users (members) to subscribe to specific topics or threads to receive notifications about new posts, comments, or updates. This facilitates personalized engagement and information delivery. \n\nNormalization: This table is fully normalized (3NF), with references only to users and content being tracked (topics/threads). All event/counter data is derived elsewhere and NOT stored here. For example, a member subscribes to a thread and chooses to receive email notifications for new comments. \n\nKey relationships: Connects to user/member accounts and references content entities like topics or threads through polymorphic association. \nSpecial behaviors: One user may have multiple subscriptions (to different threads or topics); uniqueness is typically enforced per (user, target_type, target_id) tuple.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for each subscription record."},"foreignFields":[{"name":"subscriber_id","type":"uuid","description":"Subscribed user's {@link discussion_board_members.id} (or similar actor/user id from the actors module) - Links the subscription to the specific member who will receive notifications.","relation":{"name":"fk_discussion_board_subscriptions_subscriber","targetModel":"discussion_board_members"},"unique":false,"nullable":false}],"plainFields":[{"name":"target_type","type":"string","description":"Type of subscribed entity (e.g., 'topic', 'thread'). Implements the polymorphic requirement allowing users to subscribe to both topics and threads as described in features. Ensures normalization by not duplicating data between entity types. For example, value may be 'topic' or 'thread'.","nullable":false},{"name":"target_id","type":"uuid","description":"Identifier for the target entity the subscription belongs to (may refer to either a topic or thread depending on target_type). This allows polymorphic associations without denormalization. For example, the UUID of the thread or topic being followed.","nullable":false},{"name":"subscribed_at","type":"datetime","description":"Timestamp when the subscription was created. Implements audit and tracking requirement. Ensures atomicity of event recording. For example, when the user first clicks 'subscribe' on a discussion.","nullable":false},{"name":"notification_method","type":"string","description":"Preferred notification delivery method for this subscription (e.g., 'email', 'in-app'). Implements flexible business logic for user notification preferences. Complies with normalization as all methods remain atomic here. For example, a member may choose 'email' for some threads but 'in-app' for others.","nullable":false},{"name":"is_active","type":"boolean","description":"Whether the subscription is currently active. Implements toggling or pause of notifications per subscription, as required for user experience. Ensures no derived or pre-calculated values. For example, users may mute certain subscriptions by setting this to false.","nullable":false}],"uniqueIndexes":[{"fieldNames":["subscriber_id","target_type","target_id"],"unique":true}],"plainIndexes":[{"fieldNames":["target_type","target_id"]},{"fieldNames":["subscribed_at"]}],"ginIndexes":[]},{"name":"discussion_board_notifications","description":"Notification delivery and tracking for the discussion board - Implements requirements from the 'Notification and Subscription' and related workflow/acceptance criteria, supporting delivery and audit of in-app and external notifications.\n\nBusiness purpose: Tracks each notification event sent to a user, related to activity on a subscribed topic/thread or board event. Enables notification rendering, read/unread status, preference handling, and delivery outcomes. \n\nNormalization: Table is normalized (3NF) by separating notification content, recipient, and status; no denormalized aggregates present. For example, a member gets notified of a reply to a subscribed thread, and the read status is managed here. \n\nKey Relationships: References a recipient member, may reference the subscription (optional), and stores only atomic notification delivery details. \nSpecial behaviors: Read/unread logic, delivery status, and failure reasons may be updated; past notification events are retained for audit.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique identifier for each notification."},"foreignFields":[{"name":"recipient_id","type":"uuid","description":"Recipient user's {@link discussion_board_members.id} (or similar actor/user id from actors module). Links the notification event to a specific member account.","relation":{"name":"fk_discussion_board_notifications_recipient","targetModel":"discussion_board_members"},"unique":false,"nullable":false},{"name":"subscription_id","type":"uuid","description":"(Optional) Reference to the {@link discussion_board_subscriptions.id} for the relevant subscription (if the notification was triggered by a subscription). Null when notification arises independently of a user's explicit subscription.","relation":{"name":"fk_discussion_board_notifications_subscription","targetModel":"discussion_board_subscriptions"},"unique":false,"nullable":true}],"plainFields":[{"name":"notification_type","type":"string","description":"Type/category of notification (e.g., 'new_post', 'reply', 'mention', 'system'). Implements requirement for multi-purpose notifications in features/workflow. Ensures atomicity and supports rendering. For example, 'reply' for a reply to a user's comment.","nullable":false},{"name":"target_type","type":"string","description":"Type of the entity the notification is about (e.g., 'topic', 'thread', 'post', etc.). Implements generalization of event sources in notifications. Ensures normalized mapping for polymorphic references. For example, value may be 'thread' or 'topic'.","nullable":false},{"name":"target_id","type":"uuid","description":"Identifier of the target entity (thread, topic, post, etc.) that this notification concerns. Implements polymorphic association as per requirements analysis. Ensures each notification event is atomic. For example, the UUID of the reply post discussed in notification.","nullable":false},{"name":"message","type":"string","description":"Notification message content to show the user (in-app or as short text/email). Implements audit and notification requirements by recording the actual notification content. Atomic and not pre-rendered; for example, 'You have a new reply in Thread X.'","nullable":false},{"name":"delivered_at","type":"datetime","description":"Timestamp when the notification was sent/delivered to the user. Implements delivery tracking and audit requirement. Compliant with normalization (not pre-aggregated). For example, when an email or in-app event is triggered.","nullable":false},{"name":"read_at","type":"datetime","description":"Timestamp when the notification was read/opened by the user. Optional (null if unread). Implements read/unread features and audit trail. For example, when the user first clicks on the notification.","nullable":true},{"name":"delivery_status","type":"string","description":"Status of the notification delivery (e.g., 'delivered', 'failed', 'pending'). Implements feedback loop and business requirement for retry or diagnostics. For example, 'failed' if the user's email bounced.","nullable":false},{"name":"failure_reason","type":"string","description":"Optional reason for failure if delivery_status is 'failed'. Implements troubleshooting and analytics requirements - always nullable. For example, 'invalid email address' or 'unsubscribed'.","nullable":true}],"uniqueIndexes":[{"fieldNames":["recipient_id","target_type","target_id","notification_type"],"unique":true}],"plainIndexes":[{"fieldNames":["delivered_at"]},{"fieldNames":["recipient_id","delivered_at"]}],"ginIndexes":[{"fieldName":"message"}]}]},{"filename":"schema-07-analytics.prisma","namespace":"Analytics","models":[{"name":"discussion_board_activity_logs","description":"Discussion Board Activity Log - This implements the tracking/audit trail requirement from the analytics and audit reporting sections. \n\nRecords every significant user or system action relevant for site analytics, moderation audit, and user engagement metrics. Maintains 3NF normalization by storing atomic events (each row is a single action: view, post, report, moderation action, etc), separating factual event data from analytics summaries. For example, when a member views a post or a moderator hides a comment, an entry is created here with all relevant metadata.\n\nKey relationships: references user/actor (from Actors domain), topic/thread/post (from Articles domain) when applicable.\nSpecial behaviors: immutable log (never update/delete except per retention policy); supports security, compliance, and analytics.","material":false,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique log entry identifier"},"foreignFields":[{"name":"actor_id","type":"uuid","description":"The actor's {@link discussion_board_members.id}, {@link discussion_board_moderators.id}, etc. Foreign key to user who performed the action - references the appropriate user/role table, depending on actor_type. Enables linking analytics to specific users or roles.","relation":{"name":"actor_discussion_board_activity_log_actor_id","fields":["actor_id"],"references":["id"],"targetModel":"discussion_board_members"},"unique":false,"nullable":false},{"name":"topic_id","type":"uuid","description":"The affected {@link discussion_board_topics.id}: references the discussion topic if the activity relates to a whole topic. Nullable if the activity is not scoped to a topic.","relation":{"name":"topic_discussion_board_activity_log_topic_id","fields":["topic_id"],"references":["id"],"targetModel":"discussion_board_topics"},"unique":false,"nullable":true},{"name":"thread_id","type":"uuid","description":"The affected {@link discussion_board_threads.id}: references the thread if the activity is about a particular thread. Nullable if the activity is about the whole topic or other entity.","relation":{"name":"thread_discussion_board_activity_log_thread_id","fields":["thread_id"],"references":["id"],"targetModel":"discussion_board_threads"},"unique":false,"nullable":true},{"name":"post_id","type":"uuid","description":"The affected {@link discussion_board_posts.id}. Nullable if the activity is not directly about a post (could be a view, report, thread creation, etc).","relation":{"name":"post_discussion_board_activity_log_post_id","fields":["post_id"],"references":["id"],"targetModel":"discussion_board_posts"},"unique":false,"nullable":true}],"plainFields":[{"name":"actor_type","type":"string","description":"Role type of actor performing the action (\"member\", \"moderator\", \"admin\", \"guest\"). Implements requirement to distinguish actions by role for security and analytics reporting. Ensures normalization by storing as a flag/enumeration; for example: used to partition engagement heatmaps by user type.","nullable":false},{"name":"action_type","type":"string","description":"Type of activity (\"view_topic\", \"view_post\", \"post_created\", \"comment_created\", \"report_submitted\", \"moderation_action\", etc). Implements the requirement to classify the kind of interaction for analytics/audit. Ensures normalization (atomic non-calculated field). Used when aggregating engagement stats.","nullable":false},{"name":"action_timestamp","type":"datetime","description":"Timestamp when the activity occurred. Atomic, required field for temporal analytics and ordering. Implements requirements for audit logging and report building.","nullable":false},{"name":"ip_address","type":"string","description":"IP address of the actor (if available). Implements legal compliance and security/audit requirements for analytics. Allows for location-based reporting and abuse detection. Ensures normalization by being a standalone attribute. Nullable if not collected (e.g. system action).","nullable":true},{"name":"user_agent","type":"string","description":"User agent string of the request origin (browser/device details). Implements device analytics and troubleshooting. Separate atomic data for normalization. Nullable if not recorded (e.g. system job, API).","nullable":true},{"name":"metadata_json","type":"string","description":"Extensible JSON metadata for activity-specific detail (e.g. moderation reason, previous/after details on edits, report evidence, etc). Implements the extensibility requirement from requirements analysis. Stays normalized by being a single atomic JSON dump, not denormalized fields. Allows platform extension without schema change.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["actor_id","action_timestamp"]},{"fieldNames":["topic_id","action_timestamp"]},{"fieldNames":["thread_id","action_timestamp"]},{"fieldNames":["post_id","action_timestamp"]}],"ginIndexes":[{"fieldName":"user_agent"}]},{"name":"discussion_board_engagement_stats","description":"Discussion Board Engagement Stats - Implements the requirement for summarized analytics/statistical reporting to admins and moderators, as specified in the requirements under analytics and dashboards.\n\nStores pre-calculated, periodically updated aggregate data for dashboard efficiency: e.g., daily/weekly/monthly active users, post/comment counts, report rates. Maintains normalization for atomic periods (scope is always a specific interval, such as day/week/month); each row is a summary for one period, dimension, and optional segment (e.g., by topic, role, etc).\n\nKey relationships: Segments relate to users by role/type, topics, or system-wide. Populated by background jobs. Usage example: Admin views stats dashboard; values come from here instead of slow full log scans.\nSpecial behaviors: must be marked material=true as it contains denormalized/pre-aggregated values.","material":true,"primaryField":{"name":"id","type":"uuid","description":"Primary Key. Unique stat record identifier"},"foreignFields":[{"name":"topic_id","type":"uuid","description":"Segmented stat's {@link discussion_board_topics.id}. Nullable when stats are aggregated across all topics or for site-wide metrics.","relation":{"name":"topic_discussion_board_engagement_stats_topic_id","fields":["topic_id"],"references":["id"],"targetModel":"discussion_board_topics"},"unique":false,"nullable":true}],"plainFields":[{"name":"period_start","type":"datetime","description":"Start timestamp of the analysis period (e.g., beginning of day, week, etc). Normalized: atomic, not calculated. For example, 2025-07-29 00:00:00 for daily period.","nullable":false},{"name":"period_end","type":"datetime","description":"End timestamp of the analysis period (inclusive/exclusive; as defined). Implements requirement for temporal analytics. Normalized: atomic field. For example, 2025-07-29 23:59:59 for daily aggregate.","nullable":false},{"name":"dimension","type":"string","description":"Type of dimension for stats: e.g., \"site\", \"topic\", \"role\", \"device_type\". Implements requirement to segment analytics by various attributes; normalized and not calculated. Used e.g. to report active Moderators in a week.","nullable":false},{"name":"segment_value","type":"string","description":"Value of the dimension segment (e.g., topic UUID string, \"admin\", \"moderator\", \"member\", \"guest\", \"all\"). May be a topic ID, a role name, etc. Implements requirement for multidimensional reporting; normalized as atomic segment. Example: reporting posts per role per day.","nullable":false},{"name":"post_count","type":"int","description":"Summed total of posts in the segment and period. Denormalized, thus only in materialized view. Implements requirement for rapid dashboard reporting of volume metrics; e.g., total new posts sitewide per day.","nullable":false},{"name":"comment_count","type":"int","description":"Summed total of comments created in this period/segment. Same requirements/context as post_count. Ensures denormalized aggregation is in the analytics-derived table, not original comments table.","nullable":false},{"name":"active_user_count","type":"int","description":"Number of unique active users (by actor/role/dimension) in the current period segment. Implements requirement for retention/engagement dashboard values. Denormalized, so only here. Used for key stats such as DAU/WAU/MAU.","nullable":false},{"name":"report_count","type":"int","description":"Count of abuse reports handled/raised for the segment in the period. Implements moderation workload analysis; denormalized for reporting. Used in analytics dashboard.","nullable":false}],"uniqueIndexes":[{"fieldNames":["period_start","period_end","dimension","segment_value"],"unique":true}],"plainIndexes":[{"fieldNames":["topic_id","period_start","period_end"]}],"ginIndexes":[]}]}]}